# Trickbot artifact decrypter

This is a Python 3 script that is intended to decrypt Trickbot related artifacts from a computer infected with Trickbot.


# Installation

On Linux:

```
$ python3 -m pip install -r requirements.txt
$ ./trickbot_artifact_decrypter.py
```

On Windows:

```
$ python3 -m pip install -r requirements.txt
$ ./trickbot_artifact_decrypter.py
```


# Usage

```
$ ./trickbot_artifact_decrypter.py -h
usage: trickbot_artifact_decrypter.py [-h] [-d DUMPDIR] [directory]
Decrypts and dumps various artifacts (current configuration, modules and
module configurations) from a computer infected by Trickbot
positional arguments:
  directory             Trickbot malware directory
optional arguments:
  -h, --help            show this help message and exit
  -d DUMPDIR, --dumpdir DUMPDIR
                        Dump directory for the decrypted files

$ ./trickbot_artifact_decrypter.py
[+] Found config file: './settings.ini'
    [+] Base64 alphabet: 'HJIA/CB+FGKLNOP3RSlUVWXYZfbcdeaghi5kmn0pqrstuvwx89o1246EQjM7TyDz'
    [+] Bot ID: '525D1E59E305448F4CBB6E9361053A847F8B7422D0C2FE64D1A4BB3E81FC2461'
    [+] Group tag: 'tt0002'
    [+] Client ID: 'TEST-PC_W617601.0371EAD96EA53E579A7F3674B6F02317'
    [+] Configuration: '<mcconf><ver>1000478</ver><gtag>tt0002</gtag><servs><srv>37.44.212.148:443</srv><srv>185.65.202.127:443</srv><srv>193.37.212.246:443</srv><srv>193.124.191.243:443</srv><srv>31.148.99.63:443</srv><srv>94.103.91.61:443</srv><srv>203.23.128.179:443</srv><srv>179.43.147.72:443</srv><srv>93.123.73.192:443</srv><srv>51.89.115.120:443</srv><srv>144.91.76.214:443</srv><srv>46.21.153.81:443</srv><srv>194.5.250.98:443</srv><srv>190.154.203.218:449</srv><srv>178.183.150.169:449</srv><srv>200.116.199.10:449</srv><srv>181.113.20.186:449</srv><srv>187.58.56.26:449</srv><srv>85.11.116.194:449</srv><srv>177.103.240.149:449</srv><srv>81.190.160.139:449</srv><srv>200.21.51.38:449</srv><srv>181.49.61.237:449</srv><srv>46.174.235.36:449</srv><srv>91.232.52.187:449</srv><srv>36.89.85.103:449</srv><srv>31.128.13.45:449</srv><srv>186.42.185.10:449</srv><srv>170.233.120.53:449</srv><srv>89.228.243.148:449</srv><srv>31.214.138.207:449</srv><srv>186.42.98.254:449</srv><srv>195.93.223.100:449</srv><srv>181.112.52.26:449</srv><srv>190.13.160.19:449</srv><srv>186.47.122.182:449</srv><srv>186.71.150.23:449</srv><srv>190.152.4.98:449</srv><srv>170.82.156.53:449</srv><srv>131.161.253.190:449</srv><srv>181.113.114.50:449</srv><srv>186.47.121.58:449</srv><srv>185.70.182.162:449</srv><srv>200.127.121.99:449</srv><srv>45.235.213.126:449</srv></servs><autorun><module name="systeminfo" ctl="GetSystemInfo"/><module name="pwgrab"/></autorun></mcconf>'
[+] Found module binary: './data/tabDll64'
[+] Found module config: './data/tabDll64_configs/dpost'
[+] Found module binary: './data/importDll64'
[+] Found module binary: './data/systeminfo64'
[+] Found module binary: './data/networkDll64'
[+] Found module config: './data/networkDll64_configs/dpost'
[+] Found module binary: './data/mshareDll64'
[+] Found module binary: './data/psfin64'
[+] Found module config: './data/psfin64_configs/dpost'
[+] Found module binary: './data/NewBCtestnDll64'
[+] Found module config: './data/NewBCtestnDll64_configs/bcconfig3'
[+] Found module binary: './data/injectDll64'
[+] Found module config: './data/injectDll64_configs/dinj'
[+] Found module config: './data/injectDll64_configs/sinj'
[+] Found module config: './data/injectDll64_configs/dpost'
[+] Found module binary: './data/mwormDll64'
[+] Found module binary: './data/pwgrab64'
[+] Found module config: './data/pwgrab64_configs/dpost'
[+] Saved 19 decrypted file(s) to: './decrypted'
```
